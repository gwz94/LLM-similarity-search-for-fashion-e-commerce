FROM node:20-alpine

WORKDIR /app

# Accept public runtime environment variables
ARG NEXT_PUBLIC_API_URL
ENV NEXT_PUBLIC_API_URL=$NEXT_PUBLIC_API_URL

# Optional platform settings for edge cases
ENV npm_config_platform=linux
ENV npm_config_arch=x64

# Copy package files and install dependencies
COPY package*.json ./
RUN npm install

# Workaround for lightningcss (specific to Tailwind + Next.js users)
RUN npm install lightningcss@latest --platform=linux --arch=x64

# Copy application code
COPY . .

# Expose the port the app runs on
EXPOSE 3000

# Set development environment
ENV NODE_ENV=development
ENV PORT=3000

# Start the development server with hot-reloading
CMD ["npm", "run", "dev"] 